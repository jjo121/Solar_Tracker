#include <xc.inc>

global compare1, compare2,average_p0p1_low
global compare_p0p1_h, 
global status1, status2, tempCompare1, tempCompare2,quotient
    
extrn  Photodiode_0L, Photodiode_0H,Photodiode_1L,Photodiode_1H
extrn  Photodiode_2L, Photodiode_2H,Photodiode_3L,Photodiode_3H
 
    
psect	udata_acs
	
difference_p2p3_l:  ds	1
difference_p2p3_h:  ds	1
difference_p1p3_l:  ds	1
difference_p1p3_h:  ds	1
status_p2p3_l:	    ds	1
status_p2p3_h:	    ds	1
status_p1p3_l:	    ds	1
status_p1p3_h:	    ds	1
totalp0p1H:	    ds  1
totalp0p2H:	    ds  1
totalp1p3H:	    ds  1  
totalp2p3H:	    ds  1
totalp0p1L:	    ds  1
totalp0p2L:	    ds  1
totalp1p3L:	    ds  1  
totalp2p3L:	    ds  1
psect	adc_code, class=CODE

average:
	movf	Photodiode_0H,W
	addwf	Photodiode_1H,0
	movwf	totalp0p1H
	
	movf	Photodiode_0L,W
	addwf	Photodiode_1L,0
	movwf	totalp0p1L
	
	movf	Photodiode_0H,W
	addwf	Photodiode_2H,0
	movwf	totalp0p2H
	
	movf	Photodiode_0L,W
	addwf	Photodiode_2L,0
	movwf	totalp0p2L
	
	movf	Photodiode_1H,W
	addwf	Photodiode_3H,0
	movwf	totalp1p3H
	
	movf	Photodiode_1L,W
	addwf	Photodiode_3L,0
	movwf	totalp1p3L
	
	movf	Photodiode_2H,W
	addwf	Photodiode_3H,0
	movwf	totalp2p3H
	
	movf	Photodiode_2L,W
	addwf	Photodiode_3L,0
	movwf	totalp2p3L
	return
	
	

compare_p0p2_p1p3:
	movf	Photodiode_2H,W
	subwf	Photodiode_3H,0
	movwf	difference_p2p3_h
	btfsc	STATUS, 0
	bra	compare2
	comf	difference_p2p3_h
	incf	difference_p2p3_h
	movlw	0x01
	movwf	status_p2p3_h
	bcf	STATUS,0
compare2:	
	movf	Photodiode_2L,W
	subwf	Photodiode_3L,0
	movwf	difference_p2p3_l
	btfsc	STATUS, 0
	return
	comf	difference_p2p3_l
	incf	difference_p2p3_l
	movlw	0x01
	movwf	status_p2p3_l
	return

compare_p1p3_h:
	movf	Photodiode_1H,W
	subwf	Photodiode_3H,0
	movwf	difference_p1p3_h
	btfsc	STATUS, 0
	bra	compare_p1p3_l
	comf	difference_p1p3_h
	incf	difference_p1p3_h
	movlw	0x01
	movwf	status_p1p3_h
	bcf	STATUS,0

compare_p1p3_l:	
	movf	Photodiode_1L,W
	subwf	Photodiode_3L,0
	movwf	difference_p1p3_l
	btfsc	STATUS, 0
	return
	comf	difference_p1p3_l
	incf	difference_p1p3_l
	movlw	0x01
	movwf	status_p1p3_l
	return
	end
